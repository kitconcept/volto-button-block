Refactor to use TypeScript and best practices. @sneridagh
